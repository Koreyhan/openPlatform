!function(a,b){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return b(a)}):b(a,!0)}(window,function(a,b){function l(a){if("android"==d)window.WebViewJavascriptBridge?a(window.WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){a(window.WebViewJavascriptBridge)},!1);else if("ios"==d){if(window.WebViewJavascriptBridge)return a(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(a);window.WVJBCallbacks=[a];var b=document.createElement("iframe");b.style.display="none",b.src="https://__bridge_loaded__",document.documentElement.appendChild(b),setTimeout(function(){document.documentElement.removeChild(b)},0)}else o("非app环境，无法使用SDK相关功能"),console.warn("非app环境，无法使用SDK相关功能")}function m(a,b,c){o("开始调用事件"),window.WebViewJavascriptBridge?window.WebViewJavascriptBridge.callHandler(a,p(b),function(b){n(a,b,c)}):(console.warn("调用失败，尚未完成Bridge初始化"),o("调用失败，尚未完成Bridge初始化"),n(a,{errcode:1,errmsg:"SDK尚未 config 完成",data:{}},c))}function n(a,b,c){switch(o("已经接收到回调"),o(a+"回调数据："+JSON.stringify(b)),c=c||{},c._complete&&(c._complete(b),delete c._complete),b.errcode){case"0":case 0:c.success&&c.success(b);break;case"-1":case-1:c.cancel&&c.cancel(b);break;default:c.fail&&c.fail(b)}c.complete&&c.complete(b)}function o(a){if(f&&f.debug){void 0==h&&(h=document.createElement("p"),h.setAttribute("id","bcvWalletLog"),h.style.fontSize="20px",document.documentElement.appendChild(h));var b=h.innerHTML+a+"----------";h.innerHTML=b}}function p(a){return a=a||{},a.config={appId:f.appId,signType:"sha1",timestamp:f.timestamp+"",nonceStr:f.nonceStr,signature:f.signature},o("调用数据："+JSON.stringify(a)),a}var d,e,g,h,f={},i={config:"config",requestPayment:"requestPayment",shareWechat:"shareWechat"},j={_readyCBs:[]},k={state:0,res:{}},c=navigator.userAgent.toLowerCase();return d="bitcvwallet/ios"==c.match(/bitcvwallet\/ios/i)?"ios":"bitcvwallet/android"==c.match(/bitcvwallet\/android/i)?"android":"other",g=function(){var a=c.match(/bitcvwallet\/(\d+\.\d+\.\d+)/)||c.match(/bitcvwallet\/(\d+\.\d+)/);return a?a[1]:""}(),e={config:function(a){f=a,l(function(b){b.init&&b.init(function(){}),m(i.config,a,function(){j._complete=function(){k.state=1};var a=j._readyCBs;return j.success=function(){for(var b=0,c=a.length;c>b;b++)a[b]();j._readyCBs=[]},j.fail=function(a){j._fail?j._fail(a):j.state=-1},j.complete=function(){},j}())})},ready:function(a){0!=k.state?(o("ready"),a()):j._readyCBs.push(a)},error:function(a){-1==k.state?a(k.res):j._fail=a},requestPayment:function(a){m(i.requestPayment,a,a)},shareWechat:function(a){m(i.shareWechat,a,a)}},b&&(a.bcvWallet=e),e});